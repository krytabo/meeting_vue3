{"version":3,"file":"dropdown.js","sources":["../../src/dropdown/dropdown.tsx"],"sourcesContent":["import { defineComponent, provide, reactive, ref, toRefs } from 'vue';\nimport omit from 'lodash/omit';\nimport Popup, { PopupVisibleChangeContext } from '../popup/index';\nimport DropdownMenu from './dropdown-menu';\nimport { DropdownOption, TdDropdownProps } from './type';\nimport props from './props';\nimport { usePrefixClass } from '../hooks/useConfig';\nimport { useTNodeJSX } from '../hooks/tnode';\nimport useDropdownOptions from './hooks/useDropdownOptions';\n\nexport default defineComponent({\n  name: 'TDropdown',\n  props,\n  setup(props: TdDropdownProps, { attrs, slots }) {\n    const renderTNodeJSX = useTNodeJSX();\n    const COMPONENT_NAME = usePrefixClass('dropdown');\n    const popupElem = ref(null);\n    const isPopupVisible = ref(false);\n\n    const options = useDropdownOptions(props);\n    const handleMenuClick = (data: DropdownOption, context: { e: MouseEvent }) => {\n      if (props.hideAfterItemClick) {\n        isPopupVisible.value = false;\n        props.popupProps?.onVisibleChange?.(false, context);\n      }\n      props?.onClick?.(data, context);\n    };\n\n    const handleVisibleChange = (visible: boolean, context: PopupVisibleChangeContext) => {\n      isPopupVisible.value = visible;\n      props.popupProps?.onVisibleChange?.(visible, context);\n    };\n\n    return () => {\n      const trigger = renderTNodeJSX('default');\n\n      const popupParams = {\n        ...attrs,\n        disabled: props.disabled,\n        placement: props.placement,\n        trigger: props.trigger,\n        ...omit(props.popupProps, 'onVisibleChange'),\n        overlayInnerClassName: [\n          COMPONENT_NAME.value,\n          (props.popupProps as TdDropdownProps['popupProps'])?.overlayInnerClassName,\n        ],\n      };\n\n      return (\n        <Popup\n          {...popupParams}\n          destroyOnClose\n          ref={popupElem}\n          visible={isPopupVisible.value}\n          onVisibleChange={handleVisibleChange}\n          expandAnimation\n          v-slots={{\n            content: () => (\n              <DropdownMenu {...omit(props, 'onClick')} options={options.value} onClick={handleMenuClick} />\n            ),\n          }}\n        >\n          {trigger}\n        </Popup>\n      );\n    };\n  },\n});\n"],"names":["defineComponent","name","props","setup","attrs","slots","renderTNodeJSX","useTNodeJSX","COMPONENT_NAME","usePrefixClass","popupElem","ref","isPopupVisible","options","useDropdownOptions","handleMenuClick","data","context","hideAfterItemClick","value","popupProps","onVisibleChange","onClick","handleVisibleChange","visible","trigger","popupParams","disabled","placement","omit","overlayInnerClassName","_createVNode","Popup","_mergeProps","content","DropdownMenu"],"mappings":"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"}