{"version":3,"file":"collapse-panel.js","sources":["../../src/collapse/collapse-panel.tsx"],"sourcesContent":["import { defineComponent, ref, computed, inject, Ref, toRefs, Transition } from 'vue';\nimport props from './collapse-panel-props';\nimport FakeArrow from '../common-components/fake-arrow';\nimport { CollapseValue, TdCollapsePanelProps } from './type';\nimport { useTNodeJSX, useContent } from '../hooks/tnode';\nimport { usePrefixClass } from '../hooks/useConfig';\nimport useCollapseAnimation from './useCollapseAnimation';\n\nexport default defineComponent({\n  name: 'TCollapsePanel',\n  props,\n  setup(props: TdCollapsePanelProps) {\n    const renderTNodeJSX = useTNodeJSX();\n    const renderContent = useContent();\n    const componentName = usePrefixClass('collapse-panel');\n    const disableClass = usePrefixClass('is-disabled');\n    const clickableClass = usePrefixClass('is-clickable');\n    const transitionClass = usePrefixClass('slide-down');\n    const { value, disabled, destroyOnCollapse, expandIcon } = toRefs(props);\n    const collapseValue: Ref<CollapseValue> = inject('collapseValue');\n    const updateCollapseValue: Function = inject('updateCollapseValue');\n    const getUniqId: Function = inject('getUniqId', () => undefined, false);\n    const {\n      defaultExpandAll,\n      disabled: disableAll,\n      expandIconPlacement,\n      expandOnRowClick,\n      expandIcon: expandIconAll,\n    } = inject<any>('collapseProps');\n    const innerValue = value.value || getUniqId();\n    const showExpandIcon = computed(() => (expandIcon.value === undefined ? expandIconAll.value : expandIcon.value));\n    if (defaultExpandAll.value) {\n      updateCollapseValue(innerValue);\n    }\n    const { beforeEnter, enter, afterEnter, beforeLeave, leave, afterLeave } = useCollapseAnimation();\n    const headRef = ref<HTMLElement>();\n    const isDisabled = computed(() => disabled.value || disableAll.value);\n    const isActive = computed(() =>\n      collapseValue.value instanceof Array\n        ? collapseValue.value.includes(innerValue)\n        : collapseValue.value === innerValue,\n    );\n    const classes = computed(() => {\n      return [componentName.value, { [disableClass.value]: isDisabled.value }];\n    });\n    const handleClick = (e: MouseEvent) => {\n      const canExpand =\n        (expandOnRowClick.value && e.target === headRef.value) ||\n        (e.target as Element).getAttribute('name') === 'arrow';\n      if (canExpand && !isDisabled.value) {\n        updateCollapseValue(innerValue);\n      }\n    };\n    const renderIcon = (direction: string) => {\n      return (\n        <FakeArrow\n          name=\"arrow\"\n          isActive={isActive.value}\n          overlayClassName={`${componentName.value}__icon ${componentName.value}__icon--${direction}`}\n        />\n      );\n    };\n    const renderBlank = () => {\n      return <div class={`${componentName.value}__header--blank`}></div>;\n    };\n    const renderHeader = () => {\n      const cls = [\n        `${componentName.value}__header`,\n        {\n          [clickableClass.value]: expandOnRowClick.value && !isDisabled.value,\n        },\n      ];\n      return (\n        <div ref={headRef} class={cls} onClick={handleClick}>\n          {showExpandIcon.value && expandIconPlacement.value === 'left' ? renderIcon(expandIconPlacement.value) : null}\n          {renderTNodeJSX('header')}\n          {renderBlank()}\n          {renderTNodeJSX('headerRightContent')}\n          {showExpandIcon.value && expandIconPlacement.value === 'right' ? renderIcon(expandIconPlacement.value) : null}\n        </div>\n      );\n    };\n    const renderBodyByNormal = () => {\n      return (\n        <div v-show={isActive.value} class={`${componentName.value}__body`}>\n          <div class={`${componentName.value}__content`}>{renderContent('default', 'content')}</div>\n        </div>\n      );\n    };\n    const renderBodyDestroyOnCollapse = () => {\n      return isActive.value ? (\n        <div class={`${componentName.value}__body`}>\n          <div class={`${componentName.value}__content`}>{renderContent('default', 'content')}</div>\n        </div>\n      ) : null;\n    };\n    const renderBody = () => {\n      return destroyOnCollapse.value ? renderBodyDestroyOnCollapse() : renderBodyByNormal();\n    };\n    return () => {\n      return (\n        <div class={classes.value}>\n          <div class={`${componentName.value}__wrapper`}>\n            {renderHeader()}\n            <Transition\n              name={transitionClass.value}\n              onBeforeEnter={beforeEnter}\n              onEnter={enter}\n              onAfterEnter={afterEnter}\n              onBeforeLeave={beforeLeave}\n              onLeave={leave}\n              onAfterLeave={afterLeave}\n            >\n              {renderBody()}\n            </Transition>\n          </div>\n        </div>\n      );\n    };\n  },\n});\n"],"names":["_isVNode","defineComponent","name","props","setup","renderTNodeJSX","useTNodeJSX","renderContent","useContent","componentName","usePrefixClass","disableClass","clickableClass","transitionClass","toRefs","value","disabled","destroyOnCollapse","expandIcon","collapseValue","inject","updateCollapseValue","getUniqId","defaultExpandAll","disableAll","expandIconPlacement","expandOnRowClick","expandIconAll","innerValue","showExpandIcon","computed","useCollapseAnimation","beforeEnter","enter","afterEnter","beforeLeave","leave","afterLeave","headRef","ref","isDisabled","isActive","Array","includes","classes","handleClick","e","canExpand","target","getAttribute","renderIcon","direction","_createVNode","renderBlank","renderHeader","cls","renderBodyByNormal","_withDirectives","_vShow","renderBodyDestroyOnCollapse","renderBody"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;AAMiC,SAAA,OAAA,CAAA,CAAA,EAAA;AAAA,EAAA,OAAA,OAAA,CAAA,KAAA,UAAA,IAAA,MAAA,CAAA,SAAA,CAAA,QAAA,CAAA,IAAA,CAAA,CAAA,CAAA,KAAA,iBAAA,IAAA,CAAAA,OAAA,CAAA,CAAA,CAAA,CAAA;AAAA,CAAA;AAEjC,qBAAeC,eAAgB,CAAA;AAC7BC,EAAAA,IAAM,EAAA,gBAAA;AACNC,EAAAA,KAAA,EAAAA,KAAA;EACAC,sBAAMD,MAA6B,EAAA;IACjC,IAAME,iBAAiBC,WAAY,EAAA,CAAA;IACnC,IAAMC,gBAAgBC,UAAW,EAAA,CAAA;AAC3B,IAAA,IAAAC,aAAA,GAAgBC,eAAe,gBAAgB,CAAA,CAAA;AAC/C,IAAA,IAAAC,YAAA,GAAeD,eAAe,aAAa,CAAA,CAAA;AAC3C,IAAA,IAAAE,cAAA,GAAiBF,eAAe,cAAc,CAAA,CAAA;AAC9C,IAAA,IAAAG,eAAA,GAAkBH,eAAe,YAAY,CAAA,CAAA;IACnD,IAA2DI,OAAAA,GAAAA,OAAOX,MAAK,CAAA;AAA/DY,MAAAA,KAAO,WAAPA,KAAO;AAAAC,MAAAA,QAAA,WAAAA,QAAA;AAAUC,MAAAA,4BAAAA;AAAmBC,MAAAA,UAAW,WAAXA,UAAW,CAAA;AACjD,IAAA,IAAAC,aAAA,GAAoCC,OAAO,eAAe,CAAA,CAAA;AAC1D,IAAA,IAAAC,mBAAA,GAAgCD,OAAO,qBAAqB,CAAA,CAAA;AAClE,IAAA,IAAME,SAAsB,GAAAF,MAAA,CAAO,WAAa,EAAA,YAAA;AAAA,MAAA,OAAM;OAAW,KAAK,CAAA,CAAA;IAChE,IAMFA,OAAAA,GAAAA,OAAY,eAAe,CAAA;AAL7BG,MAAAA,gBAAA,WAAAA,gBAAA;AACUC,MAAAA,UAAA,WAAVR,QAAU;AACVS,MAAAA,mBAAA,WAAAA,mBAAA;AACAC,MAAAA,gBAAA,WAAAA,gBAAA;AACYC,MAAAA,aAAA,WAAZT,UAAY,CAAA;AAER,IAAA,IAAAU,UAAA,GAAab,KAAM,CAAAA,KAAA,IAASO,SAAU,EAAA,CAAA;IACtC,IAAAO,cAAA,GAAiBC,SAAS,YAAA;AAAA,MAAA,OAAOZ,UAAA,CAAWH,UAAU,KAAY,CAAA,GAAAY,aAAA,CAAcZ,KAAQ,GAAAG,UAAA,CAAWH,KAAM,CAAA;KAAA,CAAA,CAAA;IAC/G,IAAIQ,iBAAiBR,KAAO,EAAA;MAC1BM,mBAAA,CAAoBO,UAAU,CAAA,CAAA;AAChC,KAAA;AACM,IAAA,IAAA,qBAAA,GAAqEG,oBAAqB,EAAA;AAAxFC,MAAAA,oCAAAA;AAAaC,MAAAA,KAAO,yBAAPA,KAAO;AAAAC,MAAAA,UAAA,yBAAAA,UAAA;AAAYC,MAAAA,oCAAAA;AAAaC,MAAAA,KAAO,yBAAPA,KAAO;AAAAC,MAAAA,UAAA,yBAAAA,UAAA,CAAA;IAC5D,IAAMC,UAAUC,GAAiB,EAAA,CAAA;IACjC,IAAMC,aAAaV,QAAS,CAAA,YAAA;AAAA,MAAA,OAAMd,QAAS,CAAAD,KAAA,IAASS,WAAWT,KAAK,CAAA;KAAA,CAAA,CAAA;IACpE,IAAM0B,QAAW,GAAAX,QAAA,CAAS,YAAA;AAAA,MAAA,OACxBX,aAAc,CAAAJ,KAAA,YAAiB2B,KAC3B,GAAAvB,aAAA,CAAcJ,MAAM4B,QAAS,CAAAf,UAAU,CACvC,GAAAT,aAAA,CAAcJ,KAAU,KAAAa,UAAA,CAAA;KAC9B,CAAA,CAAA;AACM,IAAA,IAAAgB,OAAA,GAAUd,SAAS,YAAM;AACtB,MAAA,OAAA,CAACrB,cAAcM,KAAO,EAAGJ,eAAAA,CAAAA,EAAAA,EAAAA,YAAa,CAAAI,KAAA,EAAQyB,UAAW,CAAAzB,KAAA,CAAO,CAAA,CAAA;AACzE,KAAC,CAAA,CAAA;AACK,IAAA,IAAA8B,WAAA,GAAc,SAAdA,WAAA,CAAeC,CAAkB,EAAA;MAC/B,IAAAC,SAAA,GACHrB,gBAAiB,CAAAX,KAAA,IAAS+B,CAAE,CAAAE,MAAA,KAAWV,OAAQ,CAAAvB,KAAA,IAC/C+B,CAAE,CAAAE,MAAA,CAAmBC,YAAa,CAAA,MAAM,CAAM,KAAA,OAAA,CAAA;AAC7C,MAAA,IAAAF,SAAA,IAAa,CAACP,UAAA,CAAWzB,KAAO,EAAA;QAClCM,mBAAA,CAAoBO,UAAU,CAAA,CAAA;AAChC,OAAA;KACF,CAAA;AACM,IAAA,IAAAsB,UAAA,GAAa,SAAbA,UAAA,CAAcC,SAAsB,EAAA;AACxC,MAAA,OAAAC,WAAA,CAAA,SAAA,EAAA;AAAA,QAAA,MAAA,EAES,OAAA;QAAA,UACKX,EAAAA,QAAA,CAAS1B,KACnB;QAAA,kBAAqBN,EAAAA,EAAAA,CAAAA,MAAAA,CAAAA,aAAA,CAAcM,KAAe,EAAA,SAAA,CAAA,CAAA,MAAA,CAAAN,aAAA,CAAcM,0BAAgBoC,SAClF,CAAA;AAAA,OAAA,EAAA,IAAA,CAAA,CAAA;KAEJ,CAAA;AACA,IAAA,IAAME,cAAc,SAAdA,cAAoB;AACxB,MAAA,OAAAD,WAAA,CAAA,KAAA,EAAA;QAAA,OAAsB3C,EAAAA,EAAAA,CAAAA,MAAAA,CAAAA,cAAcM,KAAwB,EAAA,iBAAA,CAAA;AAAA,OAAA,EAAA,IAAA,CAAA,CAAA;KAC9D,CAAA;AACA,IAAA,IAAMuC,eAAe,SAAfA,eAAqB;AACzB,MAAA,IAAMC,GAAM,GAAA,CAAA,EAAA,CAAA,MAAA,CACP9C,aAAc,CAAAM,KAAA,mCAEdH,cAAe,CAAAG,KAAA,EAAQW,gBAAiB,CAAAX,KAAA,IAAS,CAACyB,UAAW,CAAAzB,KAAA,CAElE,CAAA,CAAA;AACA,MAAA,OAAAqC,WAAA,CAAA,KAAA,EAAA;AAAA,QAAA,KAAA,EACYd,OAAS;AAAA,QAAA,OAAA,EAAOiB;iBAAcV,EAAAA,WAAAA;OACrChB,EAAAA,CAAAA,cAAA,CAAed,SAASU,mBAAoB,CAAAV,KAAA,KAAU,SAASmC,UAAW,CAAAzB,mBAAA,CAAoBV,KAAK,CAAI,GAAA,IAAA,EACvGV,eAAe,QAAQ,CAAA,EACvBgD,WAAY,EAAA,EACZhD,eAAe,oBAAoB,CAAA,EACnCwB,cAAA,CAAed,SAASU,mBAAoB,CAAAV,KAAA,KAAU,UAAUmC,UAAW,CAAAzB,mBAAA,CAAoBV,KAAK,CAAI,GAAA,IAAA,CAAA,CAAA,CAAA;KAG/G,CAAA;AACA,IAAA,IAAMyC,qBAAqB,SAArBA,qBAA2B;AAE7B,MAAA,OAAAC,cAAA,CAAAL,WAAA,CAAA,KAAA,EAAA;QAAA,OAAuC3C,EAAAA,EAAAA,CAAAA,MAAAA,CAAAA,cAAcM,KACnD,EAAA,QAAA,CAAA;AAAA,OAAA,EAAA,CAAAqC,WAAA,CAAA,KAAA,EAAA;QAAA,OAAe3C,EAAAA,EAAAA,CAAAA,MAAAA,CAAAA,cAAcM,KAAmB,EAAA,WAAA,CAAA;OAAAR,EAAAA,CAAAA,aAAA,CAAc,WAAW,SAAS,CAAA,CAAA,CAAA,CAAA,CAAA,EAAA,CAAA,CAAAmD,KAAA,EADvEjB,QAAA,CAAS1B;KAI1B,CAAA;AACA,IAAA,IAAM4C,8BAA8B,SAA9BA,8BAAoC;MACjC,OAAAlB,QAAA,CAAS1B;eACCN,EAAAA,EAAAA,CAAAA,MAAAA,CAAAA,aAAA,CAAcM;;eACZN,EAAAA,EAAAA,CAAAA,MAAAA,CAAAA,aAAA,CAAcM;UAAmBR,aAAc,CAAA,SAAA,EAAW,SAAS,CAAE,OAEpF,IAAA,CAAA;KACN,CAAA;AACA,IAAA,IAAMqD,aAAa,SAAbA,aAAmB;MACvB,OAAO3C,iBAAkB,CAAAF,KAAA,GAAQ4C,2BAA4B,EAAA,GAAIH,kBAAmB,EAAA,CAAA;KACtF,CAAA;AACA,IAAA,OAAO,YAAM;AAAA,MAAA,IAAA,KAAA,CAAA;AAET,MAAA,OAAAJ,WAAA,CAAA,KAAA,EAAA;AAAA,QAAA,OAAA,EAAYR,OAAA,CAAQ7B,KAAAA;;eACHN,EAAAA,EAAAA,CAAAA,MAAAA,CAAAA,aAAc,CAAAM,KAAA,EAAA,WAAA,CAAA;AAAA,OAAA,EAAA,CAC1BuC,YAAa,EAAA,EAAAF,WAAA,CAAA,UAAA,EAAA;QAAA,MAENvC,EAAAA,gBAAgBE,KACtB;AAAA,QAAA,eAAA,EAAeiB;mBACNC,KAAA;AAAA,QAAA,cAAA,EACKC,UACd;AAAA,QAAA,eAAA,EAAeC;mBACNC,KAAA;QAAA,cACKC,EAAAA,UAAAA;AAEb,OAAA,EAAA,OAAA,CAAA,KAAA,GAAAuB,UAAA;;;;;KAKX,CAAA;AACF,GAAA;AACF,CAAC,CAAA;;;;"}