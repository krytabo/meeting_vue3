{"version":3,"file":"useSliderMark.mjs","sources":["../../../src/slider/hooks/useSliderMark.tsx"],"sourcesContent":["import { computed, VNode, Ref } from 'vue';\nimport cloneDeep from 'lodash/cloneDeep';\nimport { SliderMarks } from '../type';\nimport { TNode } from '../../common';\nimport log from '../../_common/js/log/log';\nimport { getStopStyle } from '../util/common';\nimport TSliderMark from '../slider-mark';\n\ninterface MarkItem {\n  point: number;\n  position: number;\n  mark: string | number | TNode<{ value: number }>;\n}\n\ninterface useSliderMarkProps {\n  max: number;\n  min: number;\n  marks: number[] | SliderMarks;\n  vertical: boolean;\n  prefixName: string;\n}\n\n/**\n * 聚合管理刻度值渲染逻辑\n */\nexport const useSliderMark = (config: Ref<useSliderMarkProps>) => {\n  const name = config.value.prefixName;\n  const markList = computed(() => {\n    const markProps = config.value;\n    if (!markProps.marks) {\n      return [];\n    }\n    const legalMarks: Array<MarkItem> = [];\n    if (Array.isArray(markProps.marks)) {\n      const marksList = cloneDeep(markProps.marks).sort((a, b) => a - b);\n      const maxLimit = Math.max(...marksList, markProps.max);\n      const minLimit = Math.min(...marksList, markProps.min);\n      if (minLimit < markProps.min) {\n        log.errorOnce('TSlider', 'marks min value should >= props min');\n      }\n      if (maxLimit > markProps.max) {\n        log.errorOnce('TSlider', 'marks max value should <= props max');\n      }\n      marksList.forEach((item) => {\n        legalMarks.push({\n          point: item,\n          position: ((item - minLimit) / (maxLimit - minLimit)) * 100,\n          mark: item,\n        });\n      });\n    } else {\n      Object.keys(markProps.marks)\n        .map(parseFloat)\n        .sort((a, b) => a - b)\n        .filter((point) => point <= markProps.max && point >= markProps.min)\n        .forEach((point) => {\n          const item: MarkItem = {\n            point,\n            position: ((point - markProps.min) * 100) / (markProps.max - markProps.min),\n            mark: markProps.marks[point],\n          };\n          legalMarks.push(item);\n        });\n    }\n    return legalMarks;\n  });\n\n  const renderMask = (onChangeFn?: (point: number) => void): VNode => {\n    if (markList.value.length) {\n      return (\n        <div>\n          <div>\n            {markList.value.map((item, index) => (\n              <div\n                class={`${name}__stop ${name}__mark-stop`}\n                style={getStopStyle(item.position, config.value.vertical)}\n                key={index}\n              />\n            ))}\n          </div>\n          <div class={`${name}__mark`}>\n            {markList.value.map((item, key) => (\n              <TSliderMark\n                mark={item.mark as any}\n                point={item.point}\n                key={key}\n                style={getStopStyle(item.position, config.value.vertical)}\n                onClickMarkPoint={onChangeFn}\n              />\n            ))}\n          </div>\n        </div>\n      );\n    }\n  };\n\n  return renderMask;\n};\n"],"names":["useSliderMark","config","name","value","prefixName","markList","computed","markProps","marks","legalMarks","Array","isArray","marksList","cloneDeep","sort","a","b","maxLimit","Math","max","minLimit","min","log","errorOnce","forEach","item","push","point","position","mark","Object","keys","map","parseFloat","filter","renderMask","onChangeFn","length","index","_createVNode","getStopStyle","vertical","key"],"mappings":"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"}